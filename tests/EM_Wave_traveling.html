<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Bokeh Plot</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
        max-width: 115ch; 
        font-family: Trebuchet MS;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.3.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.3.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.3.4.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  </head>
  <body>
      
      <div style="margin-left: 50px; margin-right: 50px; margin-top: 20px; margin-bottom: 20px;">

    <div id="c480adf3-53b6-44e6-a3c9-0bcd666d819d" data-root-id="p1947" style="display: contents;"></div>
  
    <script type="application/json" id="f2419336-c93e-404d-bade-b03c3633ae6e">
      {"a28db894-752c-496d-b9ae-173d2c7089ce":{"version":"3.4.3","title":"Bokeh Application","roots":[{"type":"object","name":"Column","id":"p1947","attributes":{"children":[{"type":"object","name":"Figure","id":"p1835","attributes":{"x_range":{"type":"object","name":"Range1d","id":"p1844","attributes":{"start":-2.5,"end":2.5}},"y_range":{"type":"object","name":"Range1d","id":"p1845","attributes":{"start":-2.5,"end":2.5}},"x_scale":{"type":"object","name":"LinearScale","id":"p1846"},"y_scale":{"type":"object","name":"LinearScale","id":"p1847"},"title":{"type":"object","name":"Title","id":"p1842"},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1905","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1872","attributes":{"selected":{"type":"object","name":"Selection","id":"p1873","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1874"},"data":{"type":"map","entries":[["x",[{"type":"ndarray","array":{"type":"bytes","data":"Ubabyzsa8D9RtpvLOxrwvw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"Ubabyzsa8L9RtpvLOxrwvw=="},"shape":[2],"dtype":"float64","order":"little"}]],["y",[{"type":"ndarray","array":{"type":"bytes","data":"0jLADgdb8L/ZCJ5/aw/1vw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"2Qief2sP9b/SMsAOB1vwPw=="},"shape":[2],"dtype":"float64","order":"little"}]],["color",["black","black"]]]}}},"view":{"type":"object","name":"CDSView","id":"p1906","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1907"}}},"glyph":{"type":"object","name":"MultiLine","id":"p1902","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"}}},"nonselection_glyph":{"type":"object","name":"MultiLine","id":"p1903","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"MultiLine","id":"p1904","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.2}}}}},{"type":"object","name":"GlyphRenderer","id":"p1914","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1875","attributes":{"selected":{"type":"object","name":"Selection","id":"p1876","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1877"},"data":{"type":"map","entries":[["x",[{"type":"ndarray","array":{"type":"bytes","data":"Or9B4kuIBMBduyvOGx4EwIC3FbrrswPAo7P/pbtJA8DGr+mRi98CwOmr031bdQLADai9aSsLAsAvpKdV+6ABwFKgkUHLNgHAdZx7LZvMAMCYmGUZa2IAwHcpnwp28P+/vCFz4hUc/78DGke6tUf+v0kSG5JVc/2/jwrvafWe/L/WAsNBlcr7vxr7lhk19vq/YfNq8dQh+r+n6z7JdE35v+3jEqEUefi/NNzmeLSk97961LpQVND2v8DMjij0+/W/BcViAJQn9b9LvTbYM1P0v5K1CrDTfvO/2K3eh3Oq8r8eprJfE9bxv2SehjezAfG/q5ZaD1Mt8L/hHV3O5bHuv2wOBX4lCe2/+P6sLWVg67+E71TdpLfpvxLg/IzkDui/ndCkPCRm5r8pwUzsY73kv7Wx9JujFOO/QqKcS+Nr4b+cJYn2RYbfv7MG2VXFNNy/y+cotUTj2L/iyHgUxJHVv/6pyHNDQNK/IRYxpoXdzb9Y2NBkhDrHv5CacCODl8C/a7kgxAPps79o94AFBYyav2j3gAUFjJo/a7kgxAPpsz9+mnAjg5fAP1jY0GSEOsc/IRYxpoXdzT/1qchzQ0DSP+LIeBTEkdU/xucotUTj2D+zBtlVxTTcP5glifZFht8/PqKcS+Nr4T+1sfSboxTjPyfBTOxjveQ/ndCkPCRm5j8P4PyM5A7oP4LvVN2kt+k/+P6sLWVg6z9qDgV+JQntP+EdXc7lse4/qZZaD1Mt8D9jnoY3swHxPx6msl8T1vE/163eh3Oq8j+StQqw037zP0u9NtgzU/Q/BMViAJQn9T/AzI4o9Pv1P3nUulBU0PY/MtzmeLSk9z/t4xKhFHn4P6brPsl0Tfk/YfNq8dQh+j8a+5YZNfb6P9MCw0GVyvs/jwrvafWe/D9IEhuSVXP9PwMaR7q1R/4/uiFz4hUc/z91KZ8KdvD/P5iYZRlrYgBAdpx7LZvMAEBRoJFByzYBQC+kp1X7oAFADai9aSsLAkDoq9N9W3UCQMav6ZGL3wJAo7P/pbtJA0B/txW667MDQFy7K84bHgRAOr9B4kuIBEA="},"shape":[100],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"Or9B4kuIBMDDBoH+8bMBwJx5OERcPQPAxzLtPk3RBMAfhHhuekIGwNPxMXqvZgfABAorcI0aCMDXBwyzrkQIwDtgajbo1wfA9cPcyXTUBsAPRkvg70cFwLyeKEogTAPApXfmV64EAcB2pArR8jf9vyQG6bCpfvi/ft7DowM29L9ZRkDqgqzwv+b065liP+y/BVU931Jt6b/v91MTPP3ov3rUwdlb0+q/2Bgm+D6g7r/eUcWP5/Pxv1ZVa58rBvW/LEs9/EEu+L+t7dz+kBH7v0qUrz2aW/2/zzj/+HrF/r92+3I8Nxz/v2yZMKtARf6/OBTbFNJA/L85wOE86in5vz3LzErmM/W/hNDkXPKl8L9IAUvGb6nnv12L3oRla9y/nQOgdTOHxr/SqymwJFCnP/JLi8pCTco/2cXI6v3U0j+4sdKTZr/TPwPwnpF3HNA/0zF5R4cUwT//p8XtSvufvwxirer4jMy/9++32KDn2r86TIWbVDzjv6LXJMui0+e/3Ht8/6ur6r8hdzwHF17rv6tn5LZWtem/gk10Dmux5b/ZFNlywg/fvzaAc6RJfM6/VDHJayavpz/BojpyCjrWP6KbCr3pkeQ/NjQHh2Yo7T9aP1SPgCHyPzk/OaD8svQ/ttNOxiIh9j8zG0b1S172P4kOzhHld/U/KtDwzT2V8z8/PcUrC/TwP8rdXvTZxes/6FyQoeV05T/PDOHM/FTfP5127UXuH9Y/fmRoJ1Bn0D/YGuUeLvHNPxVDyQu+P9I/d4v4WrA92j+1rctEGkTjP9IZIWOtKes/1z6IBOYg8j8qRLKxvPH2Pw5XsBHBrPs/9Ku6dUn5/z/ObqKqPcQBQKrtacQlDgNAIJ6bOYDGA0Dh/RtzXOYDQKzfosxTdANAUBsNmPODAkA6j6a5ADQBQJCPg6N4V/8/MlQZFc8u/D+BFe2Aq0j5P0PW/6TM+fY/6uk0IoOJ9T/SwHGZXCv1Pw6BhvCP+vU/K4ygxpL39z/5y+oCDwj7P9m2tWo5+f4/gDQSDSrCAUBc9fIveyoEQPRv1p1FiAZAOr9B4kuIBEA="},"shape":[100],"dtype":"float64","order":"little"}]],["y",[{"type":"ndarray","array":{"type":"bytes","data":"ipqh3ABz7D8Hjnu+IqfgP+QdY+nDJek/ihY9+qfq8D9QrTJipvH0P8DQxiDMRfg/zQicFemU+j+VmokP+qP7P+ADVBFmVPs/pJY9wrWm+T+QXhdMh7r2PzK5k7q/y/I/2X9zUnNa7D8IsKg51ILiP1RpqeaKxtE/JbH3GQJcgj/zRitq/lDKv6orZL2XTda/WWOl9q8m2r9YNdBDcnbYvwwKWQdffdG/qqfhcUrQt78ZuloxPQrCP+AMZXzB/9k/JMhpjeav5T+Nig/PG8DtP++30PkVNvI/20OZirCH9D9WacjMoZn1P9gBgGQPTfU/PYVvpT2i8z9VN9uBibjwP+MdcWg/l+k/L11J2mBc4D9XcVeHvxTKP7Aa+PrP3bi/0i1l3ilx17/D7RfUr5riv2OAYqeoMue/rftjWCcl6b8FHI3q+VLov+Y6Z3vZ2+S/QGikejI33r/OWyOr/YfOvwkUMEbQP5s/PKbtaPQU0z8ewbNJ5JzhP35etAy2TOg/AF5VN+T07D/e0CEphh7vP3UB8IZki+4/ye+/UH876z+IUbvhDW3lP5EqrrTxLds/6CHaAi55wT/oosnXzeHFv22+oE5pNd6/KVs9vpG657/IALZAFaHuv1nAH3o8n/G/l/8803Sb8r9ZEe4cVzXyv3SXelV8fPC/2HZzCiE9678iggNficbjv4qCZITFl9a/ZPkScajXtL+oCofumObFP1/pBiVtWtg/qXFIlVva4D8XzAXPuwnjP0T8MludfOI/BCXiJO9k3j+qt/hY/tHSP217bTi8aqk/xSUKCjN/zr8Fah3WFXbhv6/gXIyqGeu/frGpNUPe8b/0qJPyt1P1vyxD42Mepfe/F17Kck+k+L+T36sGK0H4v/cMyoYGi/a/FYSCV1Cv878i0XuIDuvvv4Z0iwbDcee/IIdIZM6A3b+Jv09PeabKv2JHeJ8VW1s/Djbiyhz/wj+RJAcyktPLPwVfJRIlt8k/CKtUYiBLuT/lyxsOydi0v2u+nsZP09S/kiue9+ed479w2RhHt3PtvxcEMttNjPO/ipqh3ABz7L8="},"shape":[100],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"ipqh3ABz7D+gAsPfFkntPwnHXigFkus/zLAr0czU6T+Y36X65CvoP5O4WQ33r+Y/Zm01M6515T/PVwCT4YvkP+TrHAND+uM/9jD3JbDA4z9NCRl3NdfjPxB6iwPDLuQ/6TYCwoKy5D9yk9IlsknlP3+vDeHU2eU/8NAO3w5J5j/Dz2EFcIDmPz8RN4z9beY/oD32pEoG5j/6FeUmfEXlP/jY2zOgL+Q/hjkFDVLQ4j9M9odGsjnhPxK3tYuVBd8/mbonPgaL2z8O7lqdpzjYP2TpgCvZP9U/tKgzxgbK0j/y4Nwz+/TQP7RnMQR2oM8/9uyXpke3zj/eOHLX3g7PP+DqujiaNdA/rVBQfY080T/gKiST0GrSP4yszVNti9M/3WwK1qNq1D+IFbCfgtrUP44sHd/6ttQ/n5Fx9hPp0z+Fl4GV9WjSPxn/5geaPtA/MPAkxTECyz9qhxtUNKnEP3CGHSqCnLs/70NyvJxjqz9yivzn64ZZP+Cldc7KAae/qAJdji9dtb+dipz6Jbe8v/GCFYYZqMC/LzqEYSuUwb+ZnYFfEz/Bv4VsRcs/yb+/KDPJP6evu79GxQGXDfe2v0QzBTxBc7K/b7Ae+sDmrb9eZbQV7F6qv/WOGe9DcKu/gtXplsLpsL9DYFgXQeS2v8yyKTg8iL+/AKbuwOg8xb/YofbWYpTLvzMQ7LRUN9G/CyiHUx6y1L9yy+MgmAXYv4fXrHZJANu/GDvhl5t43b9Wu9vxilDfv+9lb6QoPOC/3qCnH+Z34L9Vn2QxQGPgv8872zwcDeC/tOiwYWAU37/YKeqcV+bdv/MxVyQPxdy/HekjIFbk27/T5z1bQHLbv3Cr8v0Ok9u/wpmXivhd3L8hMN1EGdvdv1p4p21dAeC//xVe2AFf4b881sIaf/TivxyRYRrlquS/b4yVwldo5r8Y6G/FWhLov673RZYrkOm/1m7LK/TM6r+1UgmTpLnrv5mFiUdJTuy/1A6467+K7L90YvdVunbsvz7aDq0PIey/26fsGmue679uMB0Idgfrv6aTHJWnduq/ipqh3ABz7L8="},"shape":[100],"dtype":"float64","order":"little"}]],["color",["blue","red"]],["fill_alpha",[0.1,0.1]],["line_alpha",[0.15,0.15]]]}}},"view":{"type":"object","name":"CDSView","id":"p1915","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1916"}}},"glyph":{"type":"object","name":"Patches","id":"p1911","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"field","field":"line_alpha"},"fill_color":{"type":"field","field":"color"},"fill_alpha":{"type":"field","field":"fill_alpha"},"hatch_color":{"type":"field","field":"color"}}},"nonselection_glyph":{"type":"object","name":"Patches","id":"p1912","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"field","field":"color"},"fill_alpha":{"type":"value","value":0.1},"hatch_color":{"type":"field","field":"color"},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Patches","id":"p1913","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"field","field":"color"},"fill_alpha":{"type":"value","value":0.2},"hatch_color":{"type":"field","field":"color"},"hatch_alpha":{"type":"value","value":0.2}}}}},{"type":"object","name":"GlyphRenderer","id":"p1923","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1878","attributes":{"selected":{"type":"object","name":"Selection","id":"p1879","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1880"},"data":{"type":"map","entries":[["x",[{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAAAAAAAAAAAAAAA=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAAADcL66oY9bqvw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAAAAdd3DXrm3hPw=="},"shape":[2],"dtype":"float64","order":"little"}]],["y",[{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAAAAPh04hCi7vPw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAAAAq6MZFSF2/vw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAAAB6jsBYASbIvw=="},"shape":[2],"dtype":"float64","order":"little"}]],["color",["blue","red","black"]],["labels",["E","B","S"]],["line_width",[3,3,3]]]}}},"view":{"type":"object","name":"CDSView","id":"p1924","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1925"}}},"glyph":{"type":"object","name":"MultiLine","id":"p1920","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_width":{"type":"field","field":"line_width"}}},"nonselection_glyph":{"type":"object","name":"MultiLine","id":"p1921","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.1},"line_width":{"type":"field","field":"line_width"}}},"muted_glyph":{"type":"object","name":"MultiLine","id":"p1922","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.2},"line_width":{"type":"field","field":"line_width"}}}}},{"type":"object","name":"GlyphRenderer","id":"p1934","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1890","attributes":{"selected":{"type":"object","name":"Selection","id":"p1891","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1892"},"data":{"type":"map","entries":[["x",[{"type":"ndarray","array":{"type":"bytes","data":"Ubabyzsa8D9RtpvLOxrwvw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"Ubabyzsa8D9RtpvLOxrwPw=="},"shape":[2],"dtype":"float64","order":"little"}]],["y",[{"type":"ndarray","array":{"type":"bytes","data":"2Qief2sP9T/SMsAOB1vwPw=="},"shape":[2],"dtype":"float64","order":"little"},{"type":"ndarray","array":{"type":"bytes","data":"0jLADgdb8L/ZCJ5/aw/1Pw=="},"shape":[2],"dtype":"float64","order":"little"}]],["color",["black","black"]]]}}},"view":{"type":"object","name":"CDSView","id":"p1935","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1936"}}},"glyph":{"type":"object","name":"MultiLine","id":"p1931","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"}}},"nonselection_glyph":{"type":"object","name":"MultiLine","id":"p1932","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"MultiLine","id":"p1933","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.2}}}}},{"type":"object","name":"GlyphRenderer","id":"p1943","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1893","attributes":{"selected":{"type":"object","name":"Selection","id":"p1894","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1895"},"data":{"type":"map","entries":[["x",[[-1.75,-2.1693352839727122],[-1.75,-1.4776804824924865],[-1.75,-1.75]]],["y",[[-2.0,-2.061258562581728],[-2.0,-2.0943299142532457],[-2.0,-1.5128149676073823]]],["color",["black","black","black"]]]}}},"view":{"type":"object","name":"CDSView","id":"p1944","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1945"}}},"glyph":{"type":"object","name":"MultiLine","id":"p1940","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"}}},"nonselection_glyph":{"type":"object","name":"MultiLine","id":"p1941","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"MultiLine","id":"p1942","attributes":{"xs":{"type":"field","field":"x"},"ys":{"type":"field","field":"y"},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1843","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1858"},{"type":"object","name":"WheelZoomTool","id":"p1859","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1860","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1861","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1866"},{"type":"object","name":"ResetTool","id":"p1867"},{"type":"object","name":"HelpTool","id":"p1868"}]}},"toolbar_location":null,"left":[{"type":"object","name":"LinearAxis","id":"p1853","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1854","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1855"},"major_label_policy":{"type":"object","name":"AllLabels","id":"p1856"},"major_label_text_font_size":"0pt","axis_line_width":0,"major_tick_line_color":null,"minor_tick_line_color":null,"fixed_location":0}}],"below":[{"type":"object","name":"LinearAxis","id":"p1848","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1849","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1850"},"major_label_policy":{"type":"object","name":"AllLabels","id":"p1851"},"major_label_text_font_size":"0pt","axis_line_width":0,"major_tick_line_color":null,"minor_tick_line_color":null,"fixed_location":0}}],"center":[{"type":"object","name":"Grid","id":"p1852","attributes":{"axis":{"id":"p1848"},"grid_line_color":null}},{"type":"object","name":"Grid","id":"p1857","attributes":{"dimension":1,"axis":{"id":"p1853"},"grid_line_color":null}},{"type":"object","name":"Legend","id":"p1926","attributes":{"items":[{"type":"object","name":"LegendItem","id":"p1927","attributes":{"label":{"type":"field","field":"labels"},"renderers":[{"id":"p1923"}]}}]}},{"type":"object","name":"Label","id":"p1001","attributes":{"text":"Y","x":-2.319335283972712,"y":-2.186258562581728}},{"type":"object","name":"Label","id":"p1002","attributes":{"text":"X","x":-1.4776804824924865,"y":-2.1943299142532458}},{"type":"object","name":"Label","id":"p1003","attributes":{"text":"Z","x":-1.8,"y":-1.5128149676073823}}]}},{"type":"object","name":"Slider","id":"p1869","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p1946","attributes":{"args":{"type":"map","entries":[["slider_x",{"id":"p1869"}],["slider_ang1",{"type":"object","name":"Slider","id":"p1870","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1946"}]]]},"width":500,"title":"az.","start":0,"end":90,"value":33}}],["slider_ang2",{"type":"object","name":"Slider","id":"p1871","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1946"}]]]},"width":500,"title":"alt.","start":0,"end":90,"value":77}}],["line_source",{"id":"p1878"}],["patch_source",{"id":"p1875"}],["b_box_source",{"id":"p1872"}],["f_box_source",{"id":"p1890"}],["coord_source",{"id":"p1893"}],["X_text",{"id":"p1001"}],["Y_text",{"id":"p1002"}],["Z_text",{"id":"p1003"}]]},"code":"\n\n  var x;\n  var y;\n  var z;\n  var X;\n  var Y;\n  var Z;\n\n  //CONSTANTS\n  const pi = Math.PI\n  const k = pi\n  const w = 4.\n  const t0 = 0\n  const p_num = 100\n  const epsilon = 1e-10;\n\n  const x_val = slider_x.value;\n  const a = slider_ang1.value;\n  const b = slider_ang2.value;\n\n  var EX = line_source.data.x[0];\n  var EY = line_source.data.y[0];\n  var BX = line_source.data.x[1]\n  var BY = line_source.data.y[1];\n  var SX = line_source.data.x[2];\n  var SY = line_source.data.y[2];\n\n  var X1 = patch_source.data.x[0];\n  var Y1 = patch_source.data.y[0];\n  var X2 = patch_source.data.x[1];\n  var Y2 = patch_source.data.y[1];\n\n  var B_TX = f_box_source.data['x'][0];\n  var B_TY = f_box_source.data['y'][0];\n  var B_LX = f_box_source.data['x'][1];\n  var B_LY = f_box_source.data['y'][1];\n\n  var B_BX = b_box_source.data['x'][0];\n  var B_BY = b_box_source.data['y'][0];\n  var B_RX = b_box_source.data['x'][1];\n  var B_RY = b_box_source.data['y'][1];\n\n  var CX_X = coord_source.data['x'][0];\n  var CX_Y = coord_source.data['y'][0];\n  var CY_X = coord_source.data['x'][1];\n  var CY_Y = coord_source.data['y'][1];\n  var CZ_X = coord_source.data['x'][2];\n  var CZ_Y = coord_source.data['y'][2];\n\n  //HELPER FUNCTIONS\n\n      function linspace(start, stop, num) {\n          const step = (stop - start) / (num - 1);\n          return Array.from({length: num}, (_, i) =&gt; start + step * i);\n      }\n\n      function meshgrid(x, y) {\n          const X = y.map(() =&gt; x.slice());\n          const Y = y.map(yVal =&gt; x.map(() =&gt; yVal));\n          return [X, Y];\n      }\n\n      function multiplyMatrices(a, b) {\n          const rowsA = a.length;\n          const colsA = a[0].length;\n          const rowsB = b.length;\n          const colsB = b[0].length;\n\n          if (colsA !== rowsB) {\n              throw new Error(\"Cannot multiply these matrices: dimensions do not match.\");\n          }\n\n          const result = [];\n\n          for (let i = 0; i &lt; rowsA; i++) {\n              result[i] = [];\n              for (let j = 0; j &lt; colsB; j++) {\n                  let sum = 0;\n                  for (let k = 0; k &lt; colsA; k++) {\n                      sum += a[i][k] * b[k][j];\n                  }\n                  result[i][j] = sum;\n              }\n          }\n\n          return result;\n      }\n\n      function multiplyMatrixByScalar(matrix, scalar) {\n          if (!Array.isArray(matrix)) {\n              return matrix * scalar;\n          }\n          return matrix.map(item =&gt; multiplyMatrixByScalar(item, scalar));\n      }\n\n      function transpose(matrix) {\n          return matrix[0].map((_, colIndex) =&gt; matrix.map(row =&gt; row[colIndex]));\n      }\n\n      function sin(x) {\n          return Math.sin(x);\n      }\n\n      function cos(x) {\n          return Math.cos(x);\n      }\n\n      function getShape(arr) {\n          if (!Array.isArray(arr)) {\n              return [];\n          }\n          return [arr.length].concat(getShape(arr[0]));\n      }\n\n      function zeros(arr) {\n          const shape = getShape(arr);\n\n          function createZeros(dimensions) {\n              if (dimensions.length === 0) {\n                  return 0;\n              }\n              return Array(dimensions[0]).fill().map(() =&gt; createZeros(dimensions.slice(1)));\n          }\n\n          return createZeros(shape);\n      }\n\n      function ones(arr) {\n          const shape = getShape(arr);\n\n          function createOnes(dimensions) {\n              if (dimensions.length === 0) {\n                  return 1;\n              }\n              return Array(dimensions[0]).fill().map(() =&gt; createOnes(dimensions.slice(1)));\n          }\n\n          return createOnes(shape);\n      }\n\n      function deg2rad(degrees) {\n          return degrees * (Math.PI / 180);\n      }\n\n      function projection(X, Y, Z) {\n        // Flatten the grid for easier manipulation\n        const X_flat = X.flat();\n        const Y_flat = Y.flat();\n        const Z_flat = Z.flat();\n\n        // Define rotation matrices (adjust angles as needed)\n        const theta = deg2rad(a) + epsilon;\n        const phi = deg2rad(b) + epsilon;\n\n        // Rotation matrix around Z-axis\n        const Rz = [\n            [Math.cos(theta), -Math.sin(theta), 0],\n            [Math.sin(theta),  Math.cos(theta), 0],\n            [0,                0,               1]\n        ];\n\n        // Rotation matrix around X-axis\n        const Rx = [\n            [-1, 0,              0             ],\n            [0, -Math.cos(phi), Math.sin(phi) ],\n            [0, Math.sin(phi),  -Math.cos(phi) ]\n        ];\n\n        // Combined rotation matrix\n        const R = [\n            [0, 0, 0],\n            [0, 0, 0],\n            [0, 0, 0]\n        ];\n\n        // Multiply Rx and Rz\n        for (let i = 0; i &lt; 3; i++) {\n            for (let j = 0; j &lt; 3; j++) {\n                for (let k = 0; k &lt; 3; k++) {\n                    R[i][j] += Rx[i][k] * Rz[k][j];\n                }\n            }\n        }\n\n        // Combine X, Y, Z into a single array of points\n        const points = X_flat.map((x, i) =&gt; [x, Y_flat[i], Z_flat[i]]);\n        // Apply rotation\n        const rotated_points = multiplyMatrices(points, transpose(R))\n\n        // Orthographic projection matrix (ignoring Z-axis)\n        const P = [\n            [1, 0, 0],\n            [0, 1, 0],\n            [0, 0, 0]\n        ];\n\n        // Apply projection\n        const transformed_points = multiplyMatrices(rotated_points, transpose(P))\n\n        const all = transformed_points.map(point =&gt; [point[0], point[1]]);\n\n        // Create unique pairs\n        const used = new Set();\n        const unique = all.filter(point =&gt; {\n            const key = point.join(',');  // Convert point to string for Set\n            if (!used.has(key)) {\n                used.add(key);\n                return true;\n            }\n            return false;\n        });\n\n        // Separate x and y coordinates\n        const uniqueX = unique.map(point =&gt; point[0]);\n        const uniqueY = unique.map(point =&gt; point[1]);\n\n        return [uniqueX, uniqueY];\n    }\n\n    // Generate new data\n    function space(x, y, f, order = 'xyz') {\n      const [X, Y] = meshgrid(x, y);\n      const Z = f(X, Y);\n\n      switch (order) {\n        case 'xyz':\n          return projection(X, Y, Z);\n        case 'xzy':\n          return projection(X, Z, Y);\n        case 'yzx':\n          return projection(Z, X, Y);\n        default:\n          throw new Error('Invalid order specified');\n      }\n    }\n\n\n  function Field(x, y) {\n      const result = Math.cos(k*(x+y)-w*t0);\n      return result;\n  }\n\n\n  function Poynting_vec(x, y) {\n      const result = Math.cos(k*x-w*t0)**2;\n      return result;\n  }\n  //coord\n\n  const cx = -2.5;\n  const cy = -1;\n  const cz = -1.5;\n\n  var z = linspace(cz, cz + 0.5, 2);\n  var x = multiplyMatrixByScalar(ones(z), cx);\n\n  var [X, Z] = meshgrid(x, z);\n  var Y = multiplyMatrixByScalar(ones(Z), cy);\n  var [CZ_X_new, CZ_Y_new] = projection(X, Y, Z);\n\n  x = linspace(cx, cx + 0.5, 2);\n  var y = multiplyMatrixByScalar(ones(z), cy);\n\n  var [X, Y] = meshgrid(x, y);\n  var Z = multiplyMatrixByScalar(ones(X), cz);\n  var [CX_X_new, CX_Y_new] = projection(X, Y, Z);\n\n\n  y = linspace(cy, cy + 0.5, 2);\n  z = multiplyMatrixByScalar(ones(x), cz);\n\n  [Y, Z] = meshgrid(y, z);\n  var X = multiplyMatrixByScalar(ones(Z), cx);\n  var [CY_X_new, CY_Y_new] = projection(X, Y, Z);\n\n  //transform to bottom left corner\n    function shiftArray(arr, val) {\n      const shift = val - arr[0];\n      return arr.map(element =&gt; element + shift);\n  }\n\n  const cx0 = -1.75;\n  const cy0 = -2;\n  CX_X_new = shiftArray(CX_X_new, cx0);\n  CX_Y_new = shiftArray(CX_Y_new, cy0);\n  CY_X_new = shiftArray(CY_X_new, cx0);\n  CY_Y_new = shiftArray(CY_Y_new, cy0);\n  CZ_X_new = shiftArray(CZ_X_new, cx0);\n  CZ_Y_new = shiftArray(CZ_Y_new, cy0);\n\n  //box\n  const box_width = 1.2;\n\n  z = linspace(-box_width, box_width, 2);\n  x = multiplyMatrixByScalar(ones(z), -box_width);\n\n  [X, Z] = meshgrid(x, z);\n  Y = multiplyMatrixByScalar(ones(Z), x_val);\n  const [B_LX_new, B_LY_new] = projection(X, Y, Z);\n\n  ////\n  z = linspace(-box_width, box_width, 2);\n  x = multiplyMatrixByScalar(ones(z), box_width);\n\n  [X, Z] = meshgrid(x, z);\n  Y = multiplyMatrixByScalar(ones(Z), x_val);\n  const [B_RX_new, B_RY_new] = projection(X, Y, Z);\n\n  ////\n  x = linspace(-box_width, box_width, 2);\n  z = multiplyMatrixByScalar(ones(x), box_width);\n\n  [X, Z] = meshgrid(x, z);\n  Y = multiplyMatrixByScalar(ones(Z), x_val);\n  const [B_TX_new, B_TY_new] = projection(X, Y, Z);\n\n  ////\n  x = linspace(-box_width, box_width, 2);\n  z = multiplyMatrixByScalar(ones(x), -box_width);\n\n  [X, Z] = meshgrid(x, z);\n  Y = multiplyMatrixByScalar(ones(Z), x_val);\n  const [B_BX_new, B_BY_new] = projection(X, Y, Z);\n\n  const y_end = 1.5;\n  // Y Axis\n  y = linspace(-y_end*pi, y_end*pi, 2);\n  x = zeros(y);\n\n  [X, Y] = meshgrid(x, y);\n  Z = zeros(X);\n  const [y_axis_X, y_axis_Y] = projection(X, Y, Z);\n\n  // Vectors\n  z = linspace(0, Field(x_val, 0), 2);\n  x = zeros(z);\n\n  [X, Z] = meshgrid(x, z);\n  Y = multiplyMatrixByScalar(ones(X), x_val);\n  const [EX_new, EY_new] = projection(X, Y, Z);\n\n  x = linspace(0, Field(x_val, 0), 2);\n  z = zeros(x);\n\n  [X, Z] = meshgrid(x, z);\n  Y = multiplyMatrixByScalar(ones(X), x_val);\n  const [BX_new, BY_new] = projection(X, Y, Z);\n\n\n  y = linspace(x_val, x_val + Poynting_vec(x_val, 0), 2);\n  x = zeros(y);\n\n  [X, Y] = meshgrid(x, y);\n  Z = zeros(X);\n  const [SX_new, SY_new] = projection(X, Y, Z);\n\n  // Patches\n  y = linspace(-y_end*pi, y_end*pi, p_num);\n  x = zeros(y);\n\n  [X, Y] = meshgrid(x, y);\n  Z = X.map((row, i) =&gt; row.map((_, j) =&gt; Field(X[i][j], Y[i][j])));\n\n  var [X1_new, Y1_new] = projection(X, Y, Z);\n  //\n  y = linspace(-y_end*pi, y_end*pi, p_num);\n  z = zeros(y);\n\n  [Y, Z] = meshgrid(y, z);\n  X = Y.map((row, i) =&gt; row.map((_, j) =&gt; Field(Y[i][j], Z[i][j])));\n\n  const [X2_new, Y2_new] = projection(X, Y, Z);\n\n  const end_index = X1_new.length - 1;\n  X1_new[0] = y_axis_X[0];\n  Y1_new[0] = y_axis_Y[0];\n  X1_new[end_index] = y_axis_X[1];\n  Y1_new[end_index] = y_axis_Y[1];\n\n  X2_new[0] = y_axis_X[0];\n  Y2_new[0] = y_axis_Y[0];\n  X2_new[end_index] = y_axis_X[1];\n  Y2_new[end_index] = y_axis_Y[1];\n\n  for (let i = 0; i &lt; B_TX_new.length; i++) {\n      EX[i] = EX_new[i];\n      EY[i] = EY_new[i];\n      BX[i] = BX_new[i];\n      BY[i] = BY_new[i];\n      SX[i] = SX_new[i];\n      SY[i] = SY_new[i];\n\n      B_TX[i] = B_TX_new[i];\n      B_TY[i] = B_TY_new[i];\n      B_LX[i] = B_LX_new[i];\n      B_LY[i] = B_LY_new[i];\n      B_BX[i] = B_BX_new[i];\n      B_BY[i] = B_BY_new[i];\n      B_RX[i] = B_RX_new[i];\n      B_RY[i] = B_RY_new[i];\n\n      CX_X[i] = CX_X_new[i];\n      CX_Y[i] = CX_Y_new[i];\n      CY_X[i] = CY_X_new[i];\n      CY_Y[i] = CY_Y_new[i];\n      CZ_X[i] = CZ_X_new[i];\n      CZ_Y[i] = CZ_Y_new[i];\n  }\n\n  for (let i = 0; i &lt; X1_new.length; i++) {\n      X1[i] = X1_new[i];\n      Y1[i] = Y1_new[i];\n      X2[i] = X2_new[i];\n      Y2[i] = Y2_new[i];\n  }\n\n  X_text.x = CX_X[1] - 0.15;\n  X_text.y = CX_Y[1] - 0.125;\n  Y_text.x = CY_X[1];\n  Y_text.y = CY_Y[1] - 0.1;\n  Z_text.x = CZ_X[1] - 0.05;\n  Z_text.y = CZ_Y[1];\n\n  b_box_source.change.emit();\n  line_source.change.emit();\n  patch_source.change.emit();\n  f_box_source.change.emit();\n  coord_source.change.emit();\n"}}]]]},"width":500,"title":"\\[x\\]","start":-3,"end":3,"value":0,"step":0.01}},{"id":"p1870"},{"id":"p1871"}]}}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('f2419336-c93e-404d-bade-b03c3633ae6e').textContent;
              const render_items = [{"docid":"a28db894-752c-496d-b9ae-173d2c7089ce","roots":{"p1947":"c480adf3-53b6-44e6-a3c9-0bcd666d819d"},"root_ids":["p1947"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
    <br/>
    <br/>

<hr style="height: 1px;">

<br/>

<details>
    <summary><font size="4"><b>About the Visualization</b></font></summary>


    <p><b>Plot:</b> Electric and magnetic field amplitudes of a traveling plane wave as a function spatial position are shown, at a fixed time. The Poynting vector is shown at a particular position in space, \(x_{0}\), which can be varied.</p>

    <p><b>Sliders:</b>
      <ul>
        <li>vary time \(x_{0}\) and to see the electric (E) and magnetic (B) field vectors, and the resulting pointing vector (S), at a particular position in space.</li>
        <li>vary the "alt" and "az" sliders to change the perspective view.</li>
      </ul>
    </p>

</details>

    <br/>


<details>
    <summary><font size="4"><b>Ideas for Exploration</b></font></summary>


    <p>Consider the following questions and possible actions:</p>
    <ul>
        <li>How do the electric and magetic field vectors change as a function of position, at a fixed time?</li>
        <li>What is the magnitude and direction of the Poynting vector at different locations?</li>
    </ul>
</details>

    <br/>

<details>
    <summary><font size="4"><b>Supplementary Information</b></font></summary>

    <p><i>(no further information at this time)</i></p>

</details>

    <br/>

    <hr style="height: 1px;">
    <p><i>Copyright 2023 MIT All Rights Reserved.</i></p>



    </div>
  </body>
</html>
