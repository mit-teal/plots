<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Bokeh Plot</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.6.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.6.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.6.1.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
  </head>
  <body>

    <div style="margin-left: 50px; margin-right: 50px; margin-top: 20px; margin-bottom: 20px;">

    <div id="d8d25731-77bd-49ac-a956-8000d6e0d344" data-root-id="p6699" style="display: contents;"></div>
  
    <script type="application/json" id="d81ece97-4bf4-4d34-9245-44dbe95e00f3">
      {"f80ce311-7305-4167-b75e-c2bc1342bb1c":{"version":"3.6.1","title":"Bokeh Application","roots":[{"type":"object","name":"Column","id":"p6699","attributes":{"children":[{"type":"object","name":"Figure","id":"p6620","attributes":{"width":800,"x_range":{"type":"object","name":"Range1d","id":"p6629","attributes":{"end":100}},"y_range":{"type":"object","name":"Range1d","id":"p6630","attributes":{"end":411.46698735896047}},"x_scale":{"type":"object","name":"LinearScale","id":"p6631"},"y_scale":{"type":"object","name":"LinearScale","id":"p6632"},"title":{"type":"object","name":"Title","id":"p6627"},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p6662","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p6614","attributes":{"selected":{"type":"object","name":"Selection","id":"p6615","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p6616"},"data":{"type":"map","entries":[["N2_on",{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAAAARAAAAEgAAABMAAAAUAAAAFQAAABYAAAAXAAAAGAAAABkAAAAaAAAAGwAAABwAAAAdAAAAHgAAAB8AAAAgAAAAIQAAACIAAAAjAAAAJAAAACUAAAAmAAAAJwAAACgAAAApAAAAKgAAACsAAAAsAAAALQAAAC4AAAAvAAAAMAAAADEAAAAyAAAAMwAAADQAAAA1AAAANgAAADcAAAA4AAAAOQAAADoAAAA7AAAAPAAAAD0AAAA+AAAAPwAAAEAAAABBAAAAQgAAAEMAAABEAAAARQAAAEYAAABHAAAASAAAAEkAAABKAAAASwAAAEwAAABNAAAATgAAAE8AAABQAAAAUQAAAFIAAABTAAAAVAAAAFUAAABWAAAAVwAAAFgAAABZAAAAWgAAAFsAAABcAAAAXQAAAF4AAABfAAAAYAAAAGEAAABiAAAAYwAAAGQAAAA="},"shape":[101],"dtype":"int32","order":"little"}],["S1",[0,5.600153435484742,9.8039113279732,13.47421681797669,16.79441477341733,19.851524334587282,22.696752250060452,25.36389469216912,27.876937176858736,30.253782309749866,32.508297339144875,34.65153369186666,36.69249912727095,38.638670628860424,40.496348506393915,42.27090878059911,43.96698794013435,45.5886213027358,47.139348681009444,48.62229646617922,50.04024235381885,51.39566706172258,52.690796143138044,53.92763414970506,55.10799280869732,56.23351446188087,57.305691713142,58.325884012859746,59.29533174474746,60.21516825926801,61.08643020548935,61.91006644255869,62.68694575724261,63.41786357122061,64.10354778811562,64.74466390346329,65.34181947937023,65.89556806830629,66.40641265641082,66.87480868518097,67.30116670092568,67.68585467349507,68.02920001921535,68.33149135741661,68.5929800252373,68.81388137135886,68.99437584583995,69.13460990017393,69.23469670899615,69.29471672244782,69.31471805599458,69.29471672244782,69.23469670899615,69.13460990017393,68.99437584583995,68.81388137135883,68.5929800252373,68.33149135741658,68.02920001921535,67.68585467349507,67.30116670092568,66.87480868518097,66.40641265641082,65.89556806830632,65.34181947937026,64.74466390346328,64.10354778811563,63.41786357122061,62.6869457572426,61.91006644255867,61.086430205489364,60.21516825926801,59.29533174474744,58.325884012859774,57.30569171314198,56.23351446188087,55.107992808697304,53.92763414970506,52.69079614313807,51.39566706172258,50.040242353818826,48.62229646617925,47.13934868100944,45.58862130273582,43.966987940134345,42.270908780599086,40.49634850639393,38.63867062886044,36.692499127270935,34.65153369186669,32.50829733914486,30.25378230974985,27.876937176858746,25.36389469216914,22.696752250060456,19.851524334587282,16.794414773417316,13.474216817976696,9.803911327973196,5.600153435484742,0]],["S2",[0,8.312886979658288,15.238812486739334,21.640822293264137,27.702366023479044,33.510569765227046,39.116749475097095,44.55481286605391,49.8488594025639,55.01690812520246,60.07294528565035,65.0281439681803,69.8916363331573,74.67102660220189,79.37274525816974,84.0023015322713,88.56446826826505,93.06342039594529,97.50284071468195,101.88600210068034,106.21583236229708,110.4949660939892,114.72578663252898,118.91046037023261,123.05096509032592,127.14911357221536,131.20657341445258,135.2248838038813,139.20546979740175,143.14965456112986,147.0586699195992,150.9336654969884,154.77571667775373,158.58583157130488,162.36495713179283,166.11398455736344,169.83375407191306,173.52505917517374,177.18865043303413,180.82523886862327,184.43549900541802,188.02007160583162,191.57956614252726,195.114563034218,198.62561567339435,202.11325226964982,205.57797752905753,209.02027418746002,212.44060441323018,215.8394110930749,219.2171190128447,222.57413594384343,225.91085364390165,229.22764878143244,232.52488378972703,235.80290765792597,239.06205666448295,242.30265505818716,245.5250156914226,248.7294406097044,251.91622160125917,255.08564070995817,258.2379707145901,261.3734755772275,264.4924108631021,267.59502413424525,270.6815553188917,273.75223705848657,276.80729503399016,279.8469482729597,282.87140943884515,285.8808851037393,288.8755760057684,291.85567729217473,294.82137874907494,297.77286501880917,300.71031580567615,303.63390607085967,306.5438062172143,309.44018226457956,312.32319601620657,315.19300521688456,318.04976370322584,320.89362154664013,323.72472518942595,326.54321757434263,329.3492382681343,332.1429235792657,334.9244066702704,337.693817664971,340.45128375090644,343.19692927717915,345.9308758480147,348.65324241225426,351.3641453489945,354.0636985495785,356.7520134961378,359.42919933687153,362.09536295819817,364.75060905398277,367.39504019195374]],["STOT",[0,13.91304041514303,25.042723814712534,35.115039111240826,44.496780796896374,53.36209409981433,61.81350172515755,69.91870755822302,77.72579657942264,85.27069043495233,92.58124262479522,99.67967766004696,106.58413546042824,113.30969723106232,119.86909376456366,126.27321031287042,132.5314562083994,138.6520416986811,144.6421893956914,150.50829856685957,156.25607471611593,161.89063315571178,167.41658277566702,172.83809451993767,178.15895789902322,183.38262803409623,188.51226512759456,193.55076781674106,198.5008015421492,203.36482282039788,208.14510012508856,212.84373193954707,217.46266243499633,222.0036951425255,226.46850491990847,230.8586484608267,235.1755735512833,239.42062724348003,243.59506308944495,247.70004755380424,251.7366657063437,255.7059262793267,259.6087661617426,263.4460543916346,267.21859569863165,270.9271336410087,274.5723533748975,278.15488408763395,281.6753011222263,285.1341278155227,288.5318370688393,291.8688526662912,295.14555035289777,298.36225868160636,301.519259635567,304.6167890292848,307.65503668972025,310.6341464156037,313.55421571063795,316.4152952831995,319.2173883021849,321.9604493951391,324.6443833710009,327.2690436455338,329.8342303424724,332.3396880377085,334.78510310700733,337.1701006297072,339.49424079123276,341.7570147155184,343.9578396443345,346.0960533630073,348.1709077505158,350.1815613050345,352.1270704622169,354.00637948069004,355.81830861437345,357.5615402205647,359.23460236035237,360.83584932630214,362.3634383700254,363.8153016830638,365.1891123842353,366.48224284937595,367.6917131295603,368.8141263549417,369.8455867745282,370.78159420812614,371.61690579754134,372.3453513568377,372.9595810900513,373.450711586929,373.80781302487344,374.0171371044234,374.06089759905495,373.91522288416576,373.5464282695551,372.90341615484823,371.89927428617136,370.3507624894675,367.39504019195374]]]}}},"view":{"type":"object","name":"CDSView","id":"p6663","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p6664"}}},"glyph":{"type":"object","name":"Line","id":"p6659","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"S1"},"line_color":"red","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p6660","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"S1"},"line_color":"red","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p6661","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"S1"},"line_color":"red","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p6673","attributes":{"data_source":{"id":"p6614"},"view":{"type":"object","name":"CDSView","id":"p6674","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p6675"}}},"glyph":{"type":"object","name":"Line","id":"p6670","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"S2"},"line_color":"blue","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p6671","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"S2"},"line_color":"blue","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p6672","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"S2"},"line_color":"blue","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p6683","attributes":{"data_source":{"id":"p6614"},"view":{"type":"object","name":"CDSView","id":"p6684","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p6685"}}},"glyph":{"type":"object","name":"Line","id":"p6680","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"STOT"},"line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p6681","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"STOT"},"line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p6682","attributes":{"x":{"type":"field","field":"N2_on"},"y":{"type":"field","field":"STOT"},"line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p6693","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p6617","attributes":{"selected":{"type":"object","name":"Selection","id":"p6618","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p6619"},"data":{"type":"map","entries":[["x",[94,94]],["y",[0,374.06089759905495]]]}}},"view":{"type":"object","name":"CDSView","id":"p6694","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p6695"}}},"glyph":{"type":"object","name":"Line","id":"p6690","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_dash":[6]}},"nonselection_glyph":{"type":"object","name":"Line","id":"p6691","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_alpha":0.1,"line_dash":[6]}},"muted_glyph":{"type":"object","name":"Line","id":"p6692","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_alpha":0.2,"line_dash":[6]}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p6628","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p6643"},{"type":"object","name":"WheelZoomTool","id":"p6644","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p6645","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p6646","attributes":{"syncable":false,"line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","handles":{"type":"object","name":"BoxInteractionHandles","id":"p6652","attributes":{"all":{"type":"object","name":"AreaVisuals","id":"p6651","attributes":{"fill_color":"white","hover_fill_color":"lightgray"}}}}}}}},{"type":"object","name":"SaveTool","id":"p6653"},{"type":"object","name":"ResetTool","id":"p6654"},{"type":"object","name":"HelpTool","id":"p6655"}]}},"left":[{"type":"object","name":"LinearAxis","id":"p6638","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p6639","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p6640"},"axis_label":"Entropy \\[S/k_B\\]","axis_label_standoff":12,"major_label_policy":{"type":"object","name":"AllLabels","id":"p6641"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p6633","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p6634","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p6635"},"axis_label":"\\[N_{2,ON}\\]","axis_label_standoff":12,"major_label_policy":{"type":"object","name":"AllLabels","id":"p6636"}}}],"center":[{"type":"object","name":"Grid","id":"p6637","attributes":{"axis":{"id":"p6633"}}},{"type":"object","name":"Grid","id":"p6642","attributes":{"dimension":1,"axis":{"id":"p6638"}}},{"type":"object","name":"Legend","id":"p6665","attributes":{"location":"top_left","items":[{"type":"object","name":"LegendItem","id":"p6666","attributes":{"label":{"type":"value","value":"S\u2081"},"renderers":[{"id":"p6662"}]}},{"type":"object","name":"LegendItem","id":"p6676","attributes":{"label":{"type":"value","value":"S\u2082"},"renderers":[{"id":"p6673"}]}},{"type":"object","name":"LegendItem","id":"p6686","attributes":{"label":{"type":"value","value":"S\u2081 + S\u2082"},"renderers":[{"id":"p6683"}]}}]}},{"type":"object","name":"Label","id":"p6696","attributes":{"text":"N\u2082on(max) = 94","text_align":"center","text_baseline":"middle","x":86.48,"y":381.54211555103603}}]}},{"type":"object","name":"Slider","id":"p6697","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p6698","attributes":{"args":{"type":"map","entries":[["source",{"id":"p6614"}],["max_line_source",{"id":"p6617"}],["slider",{"id":"p6697"}],["label",{"id":"p6696"}],["N_tot",1600],["p",{"id":"p6620"}]]},"code":"\n    const N1_tot_init = slider.value;\n    const N2_on_values = Array.from({length: N1_tot_init + 1}, (_, i) =&gt; i);\n\n    function logCombStirling(n, k) {\n        if (k === 0 || n === k) return 0;\n        if (k &gt; n) return -Infinity;\n        return n * Math.log(n) - k * Math.log(k) - (n - k) * Math.log(n - k);\n    }\n\n    const S1_vals = [];\n    const S2_vals = [];\n    const STOT_vals = [];\n\n    for (let N2_on = 0; N2_on &lt;= N1_tot_init; N2_on++) {\n        const S1 = logCombStirling(N1_tot_init, N1_tot_init - N2_on);\n        const S2 = logCombStirling(N_tot - N1_tot_init, N2_on);\n        S1_vals.push(S1);\n        S2_vals.push(S2);\n        STOT_vals.push(S1 + S2);\n    }\n\n    // Find the index of the maximum entropy\n    const maxEntropyIndex = STOT_vals.indexOf(Math.max(...STOT_vals));\n    const maxEntropyN2On = N2_on_values[maxEntropyIndex];\n\n    // Update data sources\n    source.data['N2_on'] = N2_on_values;\n    source.data['S1'] = S1_vals;\n    source.data['S2'] = S2_vals;\n    source.data['STOT'] = STOT_vals;\n\n    max_line_source.data['x'] = [maxEntropyN2On, maxEntropyN2On];\n    max_line_source.data['y'] = [0, Math.max(...STOT_vals)];\n\n    // Update label position and text\n    label.text = `N\u2082on(max) = ${maxEntropyN2On}`;\n    label.x = maxEntropyN2On * 0.92;\n    label.y = Math.max(...STOT_vals) * 1.02;\n\n    source.change.emit();\n    max_line_source.change.emit();\n    label.change.emit();\n\n    // Dynamically adjust axis ranges based on the current data\n    p.x_range.start = 0;\n    p.x_range.end = N1_tot_init;\n    p.y_range.start = 0;\n    p.y_range.end = Math.max(...STOT_vals) * 1.1;\n"}}]]]},"width":500,"title":"\\[N_{2,TOT}\\]","start":1,"end":800,"value":100}}]}}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('d81ece97-4bf4-4d34-9245-44dbe95e00f3').textContent;
              const render_items = [{"docid":"f80ce311-7305-4167-b75e-c2bc1342bb1c","roots":{"p6699":"d8d25731-77bd-49ac-a956-8000d6e0d344"},"root_ids":["p6699"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </div>
  </body>
</html>